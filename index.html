
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <!-- Title and other stuffs -->
  <title>Surveymate Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" >
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="author" content="">


  <!-- Stylesheets -->

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!-- Font awesome icon -->
  <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
  <!-- jQuery UI -->
  <!-- <link rel="stylesheet" href="css/jquery-ui.css">  -->
  <!-- Calendar -->
  <!-- <link rel="stylesheet" href="css/fullcalendar.css"> -->
  <!-- prettyPhoto -->
  <!-- <link rel="stylesheet" href="css/prettyPhoto.css">   -->
  <!-- Star rating -->
  <!-- <link rel="stylesheet" href="css/rateit.css"> -->
  <!-- Date picker -->
  <!-- <link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css"> -->
  <!-- CLEditor -->
  <!-- <link rel="stylesheet" href="css/jquery.cleditor.css">  -->
  <!-- Data tables -->
  <!-- <link rel="stylesheet" href="css/jquery.dataTables.css">  -->
  <!-- Bootstrap toggle -->
  <link rel="stylesheet" href="css/jquery.onoff.css">
  <!-- Main stylesheet -->
  <link href="css/style.css" rel="stylesheet">
 <!--  <link href="css/stylenew1.css" rel="stylesheet"> -->
  <!-- <link href="css/style-responsive.css" rel="stylesheet" /> -->
  <!-- Widgets stylesheet -->
  <link href="css/widgets.css" rel="stylesheet">


  <link rel="stylesheet" type="text/css" href="css/hovereffect.css" />
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,700' rel='stylesheet' type='text/css' />
  <link rel="stylesheet" type="text/css" href="css/demo.css" />
  <link rel="stylesheet" type="text/css" href="css/common.css" />

  <script src="js/jquery.js"></script> <!-- jQuery -->

  <link rel="stylesheet" href="js/leaflet-0.7.3/leaflet.css" />
  <script src="js/leaflet-0.7.3/leaflet.js"></script>
  <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
  <script src="http://matchingnotes.com/javascripts/leaflet-google.js"></script>

  <script src="js/highcharts.js"></script>
  <script src="js/chartLive.js"></script>
  <!--[if lt IE 9]>
  <script src="js/html5shiv.js"></script>
  <![endif]-->
  <!-- Favicon -->
<!--   <script src='js/ChartNew.js'></script>
  <script src="Add-ins/format.js" async></script> -->
</head>

<body>

<div class="content">

        <!-- Main bar -->
    <div class="mainbar">

      <!-- Page heading -->
      <div class="page-head">
        <h2 class="pull-left"><i class="fa fa-home"></i> Project Report</h2>

        <!-- Breadcrumb -->
        <div class="bread-crumb pull-right">
          <a href="http://surveymate.github.io/#/admin/5713f05657871011001a5638"><i class="fa fa-home"></i> Home</a>
          <!-- Divider -->
          <span class="divider">/</span>
          <a href="http://surveymate.github.io/#/admin/5713f05657871011001a5638" class="bread-current">Dashboard</a>
        </div>

        <div class="clearfix"></div>

      </div>
      <!-- Page heading ends -->



      <!-- Matter -->

      <div class="matter">
        <div class="container">
          <div class="row">
            <div class="col-md-3 col-sm-6" style="margin-left:37.5%">
              <div class="widgetnew widget-state bg-purple">
                <div class="state-icon"><i class="fa fa-users"></i></div>
                <div class="state-info">
                  <h4>Number of Responses</h4>
                  <p class="count">0</p>
                </div>
              </div>
            </div>
          </div>
          <canvas id="canvas_Line1" height="400" width="600"></canvas>
          <canvas id="canvas_Line2" height="400" width="600"></canvas>
          <canvas id="canvas_Line3" height="400" width="600"></canvas>
          <canvas id="canvas_Line4" height="400" width="600"></canvas>
          <br>
          <br>
          <table class="table table-striped">
          <caption><strong>Correlated Analytics</strong><div id="question"></div></caption>

          <thead>
            <tr>
              <th>Question 1 / Question 2</th>
              <th id="mcq_option1"></th>
              <th id="mcq_option2"></th>
              <th id="mcq_option3"></th>
              <th id="mcq_option4"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row" id="mcq_option5">1</th>
              <td id="option00"></td>
              <td id="option01"></td>
              <td id="option02"></td>
              <td id="option03"></td>
            </tr>
            <tr>
              <th scope="row" id="mcq_option6">2</th>
              <td id="option10"></td>
              <td id="option11"></td>
              <td id="option12"></td>
              <td id="option13"></td>
            </tr>
            <tr>
              <th scope="row" id="mcq_option7">3</th>
              <td id="option20"></td>
              <td id="option21"></td>
              <td id="option22"></td>
              <td id="option23"></td>
            </tr>
            <tr>
              <th scope="row" id="mcq_option8">4</th>
              <td id="option30"></td>
              <td id="option31"></td>
              <td id="option32"></td>
              <td id="option33"></td>
            </tr>
          </tbody>
        </table>
      </div>


    <!-- Matter ends -->

    </div>

   <!-- Mainbar ends -->
   <div class="clearfix"></div>

</div>
<!-- Content ends -->

<!-- Footer starts -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
            <!-- Copyright info -->
            <p class="copy">Copyright &copy; 2015 | <a href="#">Surveymate</a> </p>
      </div>
    </div>
  </div>
</footer>

<!-- Footer ends -->

<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="fa fa-chevron-up"></i></a></span>

<!-- JS -->





<script src="js/bootstrap.min.js"></script> <!-- Bootstrap -->

<!-- <script src="js/charts.js"></script> --> <!-- Charts & Graphs -->
<script src="js/app.js"></script>

<script src="js/count.js"></script>
<!-- <script src="assets/chart-master/Chart.js"></script>
<script src="js/all-chartjs.js"></script>
<script src="js/donut.js"></script>
<script src="js/layout1.js"></script> -->


<!-- <script type="text/javascript" src="js/modernizr.custom.79639.js"></script>
 --><!-- Script for this page -->
<script>
   var projectId = window.location.href.split("?")[1].split("=")[1];
   // var projectId = "57141fae59078a1100579d02"
   var url = 'http://surveymate-io.herokuapp.com/api/responses/getAnalytics?projectId='+projectId;
   // var url = 'http://surveymate-io.herokuapp.com/api/responses/getAnalytics?projectId=5713f50357871011001a5640'
   var responseCode;
   var responseText;

   var response = fetch(url, {
     method: 'GET',
     headers: {
       'Accept': 'application/json',
     }
   }).then(function (response) {
       responseCode = response.status;
       responseText = response.statusText;
       return response.text();
   }).then(function (result) {
       var jsonData = JSON.parse(result);
       if (responseCode == 200) {
         console.log("success",jsonData);
         var charJSPersonalDefaultOptions = { decimalSeparator : "," , thousandSeparator : ".", roundNumber : "none", graphTitleFontSize: 2 };

         defCanvasWidth=600;
         defCanvasHeight=400;

         var timeDependentAnalytics = jsonData.timeDependentAnalytics;
         var labels = [];
         let minDate = new Date(timeDependentAnalytics.minDate);
         let maxDate = new Date(timeDependentAnalytics.maxDate);
         let timeFrequency = timeDependentAnalytics.timeFrequency;
         var oneDay = 24*60*60*1000;
         let timeLabels = new Array(timeFrequency.length);
         let curDate = minDate.getTime();
         console.log("curDate ",curDate);
         console.log("timeFrequency ",timeFrequency);
         for(let i = 0;i<timeFrequency.length;i++){
           timeLabels[i] = new Date(curDate);
           timeLabels[i] = timeLabels[i].getDate() + " Apr";
           curDate = curDate + oneDay;
         }
         console.log('timeLabels ',timeLabels);
         console.log(timeFrequency);
         // var mydata1 = {
         //    labels : [new Date(2014,0,1,0,0,0),new Date(2014,0,1,3,0,0),new Date(2014,0,1,6,0,0),new Date(2014,0,1,9,0,0),new Date(2014,0,1,12,0,0),new Date(2014,0,1,15,0,0),new Date(2014,0,1,18,0,0),new Date(2014,0,1,21,0,0),new Date(2014,0,1,24,0,0)],
         //    datasets : [
         //      {
         //        fillColor : "rgba(220,220,220,0.5)",
         //        strokeColor : "rgba(220,220,220,1)",
         //        pointColor : "rgba(220,220,220,1)",
         //        pointStrokeColor : "rgba(220,220,220,1)",
         //        data : [95,53,99,87,73,27,82],
         //        xPos : [new Date(2014,0,1,2,43,12),new Date(2014,0,1,3,17,10),new Date(2014,0,1,7,33,25),new Date(2014,0,1,11,9,01),new Date(2014,0,1,15,52,10),new Date(2014,0,1,18,23,56),new Date(2014,0,1,21,34,41)],
         //        title : "With xPos"
         //      }
         //    ]
         //  }
         var mydata1 = {
           labels : timeLabels,
           datasets : [
             {
               fillColor : "rgba(220,220,220,0.5)",
               strokeColor : "rgba(220,220,220,1)",
               pointColor : "rgba(220,220,220,1)",
               pointStrokeColor : "rgba(220,220,220,1)",
               xPos : timeLabels,
               data : timeFrequency,
               title : "With xPos"
             }
           ]
         }
          var opt2 = {
             animation : true,
             canvasBorders : true,
             inGraphDataShow : false,
             startAngle : 0,
             inGraphDataPaddingRadius : 65,
             legend: true,
             inGraphDataTmpl: "<%=v6%>",
             inGraphDataAlign : "center",
             inGraphDataValign : "middle",
             percentageInnerCutout : 90,
             spaceRight : 140,
             spaceLeft : 140,
             spaceTop : 80,
             spaceBottom : 80,
             inGraphDataFontSize: 15,
             inGraphDataFontColor :["#F7464A","#46BFBD","#FDB45C","#81C784"],
             annotateDisplay : true,
             canvasBackgroundColor: "#EFF5FB",
             graphTitle : "Time graphic"
         }
          var singleQuestionAnalytics = jsonData.singleQuestionAnalytics;
          var singleQuestionAnalyticsOptions = [];
          var singleQuestionAnalyticsData = [];
          var frequency;
          var mcq_options;
           for(let i = 0;i<singleQuestionAnalytics.length-1;i++){
             singleQuestionAnalyticsOptions[i] = JSON.parse(JSON.stringify(opt2));
             singleQuestionAnalyticsOptions[i].graphTitle = singleQuestionAnalytics[i].question_text;
             frequency = singleQuestionAnalytics[i].frequency;
             mcq_options = singleQuestionAnalytics[i].mcq_options;
             console.log(frequency);
             // console.log(mcq_options);
             singleQuestionAnalyticsData[i] = [
               {
                 value : frequency[0],
                 color: "#F7464A",
                 title: mcq_options[0]
               },
               {
                 value : frequency[1],
                 color: "#46BFBD",
                 title: mcq_options[1]
               },
               {
                 value : frequency[2],
                 color: "#FDB45C",
                 title: mcq_options[2]
               },
               {
                 value : frequency[3],
                 color: "#81C784",
                 title: mcq_options[3]
               }
             ]
           }
           singleQuestionAnalyticsOptions[2] = JSON.parse(JSON.stringify(opt2));
           singleQuestionAnalyticsOptions[2].graphTitle = singleQuestionAnalytics[2].question_text;
           frequency = singleQuestionAnalytics[2].frequency;
           frequency.splice(-1,1)
         var mydata2 = [
         {
           value : 7,
           color: "#F7464A",
           title : "Sektorius 1"
         },
         {
           value : 20,
           color: "#46BFBD",
               title : "Sektorius 2"
         },
         {
           value : 11,
           color: "#FDB45C",
               title : "Sektorius 3"
         },
         {
           value : 17,
           color: "#81C784",
               title : "Sektorius 4"
         }
       ];

       var mydata3 = {
            labels : [1,2,3,4,5,6,7,8,9,10],
            datasets : [
              {
                fillColor : "rgba(220,220,220,0.5)",
                strokeColor : "rgba(220,220,220,1)",
                pointColor : "rgba(220,220,220,1)",
                pointStrokeColor : "rgba(220,220,220,1)",
                data : frequency,
                xPos : [1,2,3,4,5,6,7,8,9,10],
                title : "With xPos"
              }
            ]
          }


         var opt1 = {
               canvasBorders : true,
               canvasBordersWidth : 3,
               canvasBordersColor : "black",
               graphTitle : "Time Related Analytics",
               legend : true,
               inGraphDataShow : true,
               inGraphDataTmpl : "<%=v3%>",
               fmtV2 : "fmtdatetime MM/DD/YYYY HH:mm:ss",
               graphTitleFontSize: 18,
               fmtXLabel : "fmttime HH:mm",
               graphMin : 0,
               yAxisMinimumInterval : 5,
         }

         var opt3 = {
               canvasBorders : true,
               canvasBordersWidth : 3,
               canvasBordersColor : "black",
               graphTitle : "Time Related Analytics",
               legend : true,
               inGraphDataShow : true,
               inGraphDataTmpl : "<%=v3%>",
               fmtV2 : "fmtdatetime MM/DD/YYYY HH:mm:ss",
               graphTitleFontSize: 18,
               fmtXLabel : "fmttime HH:mm",
               graphMin : 0,
               yAxisMinimumInterval : 5,
         }

         var opt2 = {
             animation : true,
             canvasBorders : true,
             inGraphDataShow : false,
             startAngle : 0,
             inGraphDataPaddingRadius : 65,
             legend: true,
             inGraphDataTmpl: "<%=v6+' %\n'+v1%>",
             inGraphDataAlign : "center",
             inGraphDataValign : "middle",
             percentageInnerCutout : 90,
             spaceRight : 140,
             spaceLeft : 140,
             spaceTop : 80,
             spaceBottom : 80,
             inGraphDataFontSize: 15,
             inGraphDataFontColor :["#F7464A","#46BFBD","#FDB45C","#81C784"],
             annotateDisplay : true,
             canvasBackgroundColor: "#EFF5FB",
             graphTitle : "Time graphic"
         }
         
         var correlatedAnalytics = jsonData.correlatedAnalytics[0];
         
         var questions = document.getElementById('question');
         questions.innerHTML = 'Question 1 : ' + correlatedAnalytics.question_text1 + '&nbsp;&nbsp;and&nbsp;&nbsp;Question 2 : ' +correlatedAnalytics.question_text2;

         var mcq_option1 = document.getElementById('mcq_option1');
         mcq_option1.innerHTML = correlatedAnalytics.mcq_options2[0];
         var mcq_option2 = document.getElementById('mcq_option2');
         mcq_option2.innerHTML = correlatedAnalytics.mcq_options2[1];
         var mcq_option3 = document.getElementById('mcq_option3');
         mcq_option3.innerHTML = correlatedAnalytics.mcq_options2[2];
         var mcq_option4 = document.getElementById('mcq_option4');
         mcq_option4.innerHTML = correlatedAnalytics.mcq_options2[3];

         var mcq_option5 = document.getElementById('mcq_option5');
         mcq_option5.innerHTML = correlatedAnalytics.mcq_options1[0];
         var mcq_option6 = document.getElementById('mcq_option6');
         mcq_option6.innerHTML = correlatedAnalytics.mcq_options1[1];
         var mcq_option7 = document.getElementById('mcq_option7');
         mcq_option7.innerHTML = correlatedAnalytics.mcq_options1[2];
         var mcq_option8 = document.getElementById('mcq_option8');
         mcq_option8.innerHTML = correlatedAnalytics.mcq_options1[3];

         var option00 = document.getElementById('option00');
         option00.innerHTML = correlatedAnalytics.grid[0][0];
         var option01 = document.getElementById('option01');
         option01.innerHTML = correlatedAnalytics.grid[0][1];
         var option02 = document.getElementById('option02');
         option02.innerHTML = correlatedAnalytics.grid[0][2];
         var option03 = document.getElementById('option03');
         option03.innerHTML = correlatedAnalytics.grid[0][3];

         var option10 = document.getElementById('option10');
         option10.innerHTML = correlatedAnalytics.grid[1][0];
         var option11 = document.getElementById('option11');
         option11.innerHTML = correlatedAnalytics.grid[1][1];
         var option12 = document.getElementById('option12');
         option12.innerHTML = correlatedAnalytics.grid[1][2];
         var option13 = document.getElementById('option13');
         option13.innerHTML = correlatedAnalytics.grid[1][3];

         var option20 = document.getElementById('option20');
         option20.innerHTML = correlatedAnalytics.grid[2][0];
         var option21 = document.getElementById('option21');
         option21.innerHTML = correlatedAnalytics.grid[2][1];
         var option22 = document.getElementById('option22');
         option22.innerHTML = correlatedAnalytics.grid[2][2];
         var option23 = document.getElementById('option23');
         option23.innerHTML = correlatedAnalytics.grid[2][3];

         var option30 = document.getElementById('option30');
         option30.innerHTML = correlatedAnalytics.grid[3][0];
         var option31 = document.getElementById('option31');
         option31.innerHTML = correlatedAnalytics.grid[3][1];
         var option32 = document.getElementById('option32');
         option32.innerHTML = correlatedAnalytics.grid[3][2];
         var option33 = document.getElementById('option33');
         option33.innerHTML = correlatedAnalytics.grid[3][3];

          setTimeout(function(){
          var myLine1 = new Chart(document.getElementById("canvas_Line1").getContext("2d")).Bar(mydata1,opt1);
          var myLine2 = new Chart(document.getElementById("canvas_Line2").getContext("2d")).Pie(singleQuestionAnalyticsData[0],singleQuestionAnalyticsOptions[0]);
          var myLine3 = new Chart(document.getElementById("canvas_Line3").getContext("2d")).Pie(singleQuestionAnalyticsData[1],singleQuestionAnalyticsOptions[1]);
          var myLine4 = new Chart(document.getElementById("canvas_Line4").getContext("2d")).Bar(mydata3,singleQuestionAnalyticsOptions[2]);

          },2000);
         
          var se = document.createElement('script');
          se.type = "text/javascript";
          se.src = "js/ChartNew.js";
          document.getElementsByTagName('head')[0].appendChild(se);
          var fe = document.createElement('script');
          fe.type = "text/javascript";
          fe.src = "Add-ins/format.js";
          document.getElementsByTagName('head')[0].appendChild(fe);

       }
       else {
         console.log("failure");
       }
   }).catch(function (error) {
     console.error('An error occured');
     console.error(error);
   });
 </script>
  
</body>
</html>
