
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <!-- Title and other stuffs -->
  <title>Surveymate Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" >
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="author" content="">


  <!-- Stylesheets -->

  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!-- Font awesome icon -->
  <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css">
  <!-- jQuery UI -->
  <!-- <link rel="stylesheet" href="css/jquery-ui.css">  -->
  <!-- Calendar -->
  <!-- <link rel="stylesheet" href="css/fullcalendar.css"> -->
  <!-- prettyPhoto -->
  <!-- <link rel="stylesheet" href="css/prettyPhoto.css">   -->
  <!-- Star rating -->
  <!-- <link rel="stylesheet" href="css/rateit.css"> -->
  <!-- Date picker -->
  <!-- <link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css"> -->
  <!-- CLEditor -->
  <!-- <link rel="stylesheet" href="css/jquery.cleditor.css">  -->
  <!-- Data tables -->
  <!-- <link rel="stylesheet" href="css/jquery.dataTables.css">  -->
  <!-- Bootstrap toggle -->
  <link rel="stylesheet" href="css/jquery.onoff.css">
  <!-- Main stylesheet -->
  <link href="css/style.css" rel="stylesheet">
 <!--  <link href="css/stylenew1.css" rel="stylesheet"> -->
  <!-- <link href="css/style-responsive.css" rel="stylesheet" /> -->
  <!-- Widgets stylesheet -->
  <link href="css/widgets.css" rel="stylesheet">


  <link rel="stylesheet" type="text/css" href="css/hovereffect.css" />
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,700' rel='stylesheet' type='text/css' />
  <link rel="stylesheet" type="text/css" href="css/demo.css" />
  <link rel="stylesheet" type="text/css" href="css/common.css" />

  <script src="js/jquery.js"></script> <!-- jQuery -->

  <link rel="stylesheet" href="js/leaflet-0.7.3/leaflet.css" />
  <script src="js/leaflet-0.7.3/leaflet.js"></script>
  <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
  <script src="http://matchingnotes.com/javascripts/leaflet-google.js"></script>

  <script src="js/highcharts.js"></script>
  <script src="js/chartLive.js"></script>
  <!--[if lt IE 9]>
  <script src="js/html5shiv.js"></script>
  <![endif]-->
  <script src='js/ChartNew.js'></script>


  <!-- Favicon -->
</head>

<body>

<div class="content">

        <!-- Main bar -->
    <div class="mainbar">

      <!-- Page heading -->
      <div class="page-head">
        <h2 class="pull-left"><i class="fa fa-home"></i> Project Report</h2>

        <!-- Breadcrumb -->
        <div class="bread-crumb pull-right">
          <a href="http://surveymate.github.io/#/admin/5713f05657871011001a5638"><i class="fa fa-home"></i> Home</a>
          <!-- Divider -->
          <span class="divider">/</span>
          <a href="http://surveymate.github.io/#/admin/5713f05657871011001a5638" class="bread-current">Dashboard</a>
        </div>

        <div class="clearfix"></div>

      </div>
      <!-- Page heading ends -->



      <!-- Matter -->

      <div class="matter">
        <div class="container">

          <div class="row">
            <div class="col-md-3 col-sm-6" style="margin-left:37.5%">
              <div class="widgetnew widget-state bg-purple">
                <div class="state-icon"><i class="fa fa-users"></i></div>
                <div class="state-info">
                  <h4>Number of Responses</h4>
                  <p class="count">0</p>
                </div>
              </div>
            </div>
          </div>
          <canvas id="canvas_Line1" height="400" width="600"></canvas>
          <canvas id="canvas_Line2" height="400" width="600"></canvas>
          <canvas id="canvas_Line3" height="400" width="600"></canvas>
          <canvas id="canvas_Line4" height="400" width="600"></canvas>
          <canvas id="canvas_Line5" height="400" width="600"></canvas>
      </div>

    <!-- Matter ends -->

    </div>

   <!-- Mainbar ends -->
   <div class="clearfix"></div>

</div>
<!-- Content ends -->

<!-- Footer starts -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
            <!-- Copyright info -->
            <p class="copy">Copyright &copy; 2015 | <a href="#">Surveymate</a> </p>
      </div>
    </div>
  </div>
</footer>

<!-- Footer ends -->

<!-- Scroll to top -->
<span class="totop"><a href="#"><i class="fa fa-chevron-up"></i></a></span>

<!-- JS -->





<script src="js/bootstrap.min.js"></script> <!-- Bootstrap -->

<!-- <script src="js/charts.js"></script> --> <!-- Charts & Graphs -->
<script src="js/app.js"></script>

<script src="js/count.js"></script>
<!-- <script src="assets/chart-master/Chart.js"></script>
<script src="js/all-chartjs.js"></script>
<script src="js/donut.js"></script>
<script src="js/layout1.js"></script> -->


<!-- <script type="text/javascript" src="js/modernizr.custom.79639.js"></script>
 --><!-- Script for this page -->
 <script>
   // var projectId = window.location.href.split("?")[1].split("=")[1];
   var projectId = "57141fae59078a1100579d02"
   var url = 'http://surveymate-io.herokuapp.com/api/responses/getAnalytics?projectId='+projectId;
   // var url = 'http://surveymate-io.herokuapp.com/api/responses/getAnalytics?projectId=5713f50357871011001a5640'
   var responseCode;
   var responseText;
   var mydata1;
   var mydata2;
   var opt1;
   var opt2;// console.log(params);
   var response = fetch(url, {
     method: 'GET',
     headers: {
       'Accept': 'application/json',
     }
   }).then(function (response) {
       responseCode = response.status;
       responseText = response.statusText;
       return response.text();
   }).then(function (result) {
       var jsonData = JSON.parse(result);
       if (responseCode == 200) {
         console.log("success",jsonData);
         var charJSPersonalDefaultOptions = { decimalSeparator : "," , thousandSeparator : ".", roundNumber : "none", graphTitleFontSize: 2 };

         defCanvasWidth=600;
         defCanvasHeight=400;

         var timeDependentAnalytics = jsonData.timeDependentAnalytics;
         var labels = [];
         let minDate = new Date(timeDependentAnalytics.minDate);
         let maxDate = new Date(timeDependentAnalytics.maxDate);
         let timeFrequency = timeDependentAnalytics.timeFrequency;
         var oneDay = 24*60*60*1000;
         let timeLabels = new Array(timeFrequency.length);
         let curDate = minDate.getTime();
         console.log("curDate ",curDate);
         console.log("timeFrequency ",timeFrequency);
         for(let i = 0;i<timeFrequency.length;i++){
           timeLabels[i] = new Date(minDate.getYear(),minDate.getMonth(),minDate.getDate(),0,0,0);
           curDate = curDate + oneDay;
         }
         console.log('timeLabels ',timeLabels[0].getDate());
         mydata1 = {
           labels : timeLabels,
           datasets : [
             {
               fillColor : "rgba(220,220,220,0.5)",
               strokeColor : "rgba(220,220,220,1)",
               pointColor : "rgba(220,220,220,1)",
               pointStrokeColor : "rgba(220,220,220,1)",
               data : timeFrequency,
               title : "With xPos"
             }
           ]
         }
         mydata2 = [
         {
           value : 7,
           color: "#F7464A",
               title : "Sektorius 1"
         },
         {
           value : 20,
           color: "#46BFBD",
               title : "Sektorius 2"
         },
         {
           value : 11,
           color: "#FDB45C",
               title : "Sektorius 3"
         },
         {
           value : 17,
           color: "#81C784",
               title : "Sektorius 4"
         }
       ];


         opt1 = {
               canvasBorders : true,
               canvasBordersWidth : 3,
               canvasBordersColor : "black",
               graphTitle : "Time graphic",
               legend : true,
               inGraphDataShow : true,
               inGraphDataTmpl : "<%=v3 + ' (' + v2 + ')'%>",
               fmtV2 : "fmtdatetime MM/DD/YYYY HH:mm:ss",
               graphTitleFontSize: 18,
               fmtXLabel : "fmttime HH:mm",
               graphMin : 0,
               yAxisMinimumInterval : 5,
         }

         opt2 = {
             animation : true,
             canvasBorders : true,
             inGraphDataShow : true,
             startAngle : 0,
             inGraphDataPaddingRadius : 65,
             inGraphDataTmpl: "<%=v6+' %\n'+v1%>",
             inGraphDataAlign : "center",
             inGraphDataVAlign : "middle",
             percentageInnerCutout : 90,
             spaceRight : 140,
             spaceLeft : 140,
             spaceTop : 80,
             spaceBottom : 80,
             inGraphDataFontSize: 25,
             inGraphDataFontColor :["#F7464A","#46BFBD","#FDB45C","#81C784"],
             annotateDisplay : true,
             canvasBackgroundColor: "#EFF5FB",
             graphTitle : "Time graphic"
         }

       }
       else {
         console.log("failure");
       }
   }).catch(function (error) {
     console.error('An error occured');
     console.error(error);
   });
 </script>

<script>
setTimeout(function() {
  console.log(mydata1)
  var myLine1 = new Chart(document.getElementById("canvas_Line1").getContext("2d")).Line(mydata1,opt1);
  var myLine2 = new Chart(document.getElementById("canvas_Line2").getContext("2d")).Pie(mydata2,opt2);
  var myLine3 = new Chart(document.getElementById("canvas_Line3").getContext("2d")).Line(mydata1,opt1);
  var myLine4 = new Chart(document.getElementById("canvas_Line4").getContext("2d")).Line(mydata1,opt1);
},5000);
  // document.write("<canvas id=\"canvas_Line1\" height=\""+defCanvasHeight+"\" width=\""+defCanvasWidth+"\"></canvas>");
  </script>
   <script>
   function fmtChartJSPerso(config, value, fmt) {
     var return_value, spltdt;
     switch (fmt.split(/[\s,]+/)[0].toUpperCase()) {
       case "FIXEDDECIMAL":
       case "DECIMAL":
         var spltdt = Math.round(fmt.split(/[\s,]+/)[1]);
         var roundVal;
         if (spltdt <= 0) {
           roundVal = -spltdt;
           return_value = +(Math.round(value + "e+" + roundVal) + "e-" + roundVal);
           // Force number of decimals;
           if(fmt.split(/[\s,]+/)[0].toUpperCase()=="FIXEDDECIMAL") return_value=return_value.toFixed(Math.abs(spltdt));
         } else {
           roundVal = spltdt;
           var divval = "1e+" + roundVal;
           return_value = +(Math.round(value / divval)) * divval;
         }
         if (config.decimalSeparator != "." || config.thousandSeparator != "") {
           return_value = value.toString().replace(/\./g, config.decimalSeparator);
           if (config.thousandSeparator != "") {
             var part1 = return_value;
             var part2 = "";
             var posdec = part1.indexOf(config.decimalSeparator);
             if (posdec >= 0) {
               part2 = part1.substring(posdec + 1, part1.length);
               part2 = part2.split('').reverse().join(''); // reverse string
               part1 = part1.substring(0, posdec);
             }
             part1 = part1.toString().replace(/\B(?=(\d{3})+(?!\d))/g, config.thousandSeparator);
             part2 = part2.split('').reverse().join(''); // reverse string
             return_value = part1
             if (part2 != "") return_value = return_value + config.decimalSeparator + part2;
           }
         }
         break;
       case "ABBREVIATENUMBER":
         return_value = value;
         if (typeof(value) == "number") {
           return_value = abbreviateNumber(value);
         }
         break;
       case "DATE":
         spltdt = fmt.replace(/,/g, " ").replace(/:/g, " ").split(/[\s,]+/);
         var options = new Array();
         for (var i = 1; i < spltdt.length; i++) {
           switch (spltdt[i].toUpperCase()) {
             case "WEEKDAY":
             case "YEAR":
             case "MONTH":
             case "DAY":
               options[spltdt[i]] = spltdt[i + 1];
               break;
             default:
               break;
           }
         }
         return_value = value.toLocaleDateString(fmt.split(" ")[1], options);
         break;
       case "FMTDATE":
         spltdt = fmt.split(/[\s,]+/)[1].toUpperCase();
         return_value = spltdt.replaceArray(["DD", "MM", "YYYY", "YY"], [value.getDate(), 1 + value.getMonth(), value.getFullYear(), value.getYear() % 100]);
         break;
       case "TIME":
         return_value = value.toLocaleTimeString();
         break;
       case "FMTTIME":
         spltdt = fmt.split(/[\s,]+/)[1].toUpperCase();
         return_value = spltdt.replaceArray(["HH", "MM", "SS"], [
           value.getHours() < 10 ? '0' + value.getHours() : value.getHours(),
           value.getMinutes() < 10 ? '0' + value.getMinutes() : value.getMinutes(),
           value.getSeconds() < 10 ? '0' + value.getSeconds() : value.getSeconds()
         ]);
         break;
       case "FMTDATETIME":
         spltdt = fmt.splitLimit(/[\s,]+/, 2)[1];
         return_value = spltdt.replaceArray(["DD", "MM", "YYYY", "YY", "HH", "mm", "ss"], [
           value.getDate(), 1 + value.getMonth(), value.getFullYear(), value.getYear() % 100,
           value.getHours() < 10 ? '0' + value.getHours() : value.getHours(),
           value.getMinutes() < 10 ? '0' + value.getMinutes() : value.getMinutes(),
           value.getSeconds() < 10 ? '0' + value.getSeconds() : value.getSeconds()
         ]);
         break;
       default:
         return_value = value;
         break;
     }
     return (return_value);
   }

   function abbreviateNumber(num) {
     var suffixes = ["", "k", "m", "b","t"];
     var sign = num > 0 ? 1 : -1;
     if (num < 1000 && num > -1000 ) return num;
     var i = parseInt(Math.floor(Math.log(Math.abs(num)) / Math.log(1000)));
     return ((i % 1 == 0 ) ? (num / Math.pow(1000, i)) : (num / Math.pow(1000, i)).toFixed(1)) + '' + suffixes[i];
   };

   String.prototype.replaceArray = function(find, replace) {
     var replaceString = this;
     var regex;
     for (var i = 0; i < find.length; i++) {
       regex = new RegExp(find[i], "g");
       replaceString = replaceString.replace(regex, replace[i]);
     }
     return replaceString;
   };
   /**
    * split a string into an array with limit entries
    * The last entry contains the last part of the string, which can contain the separator)
    * @param separator {string} string separator
    * @param limit {integer} number of entries in the array
    * @return array of separated strings
    */
   String.prototype.splitLimit = function(separator, limit) {
     var splitString = this;
     var result = [];
     var pos = splitString.search(separator);
     if (pos < 0) return false;
     result.push(splitString.substring(0, pos));
     result.push(splitString.substring(pos + 1));
     return result;
   }

   </script>
</body>
</html>
